/*
 * Copyright (c) Kuba SzczodrzyÅ„ski 2022-10-4.
 */

package io.github.cloudcutter.work.exploit

import android.content.Context
import io.github.cloudcutter.work.exceptions.CloudcutterException
import io.github.cloudcutter.work.exceptions.CloudcutterTextException
import io.github.cloudcutter.work.exploit.action.Action

class ActionState(val action: Action) {
	var progress: Boolean = true
	var error: Exception? = null

	fun getAsString(context: Context): String {
		val text = action.title?.format(context)
		val e = error
		return when {
			progress -> "Action(progress, $text)"
			e != null -> when (e) {
				is CloudcutterTextException -> e.text.format(context)
				is CloudcutterException -> e.message
				else -> e.toString()
			}.let { "Action(error, $text, $it)" }
			else -> "Action(done, $text)"
		}
	}
}
